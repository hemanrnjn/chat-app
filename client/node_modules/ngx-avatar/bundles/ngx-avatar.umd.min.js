!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("is-retina"),require("ts-md5/dist/md5"),require("@angular/core"),require("@angular/common/http"),require("@angular/common")):"function"==typeof define&&define.amd?define("ngx-avatar",["exports","is-retina","ts-md5/dist/md5","@angular/core","@angular/common/http","@angular/common"],e):e(t["ngx-avatar"]={},t.isRetina,t.md5,t.ng.core,t.ng.common.http,t.ng.common)}(this,function(t,r,e,o,n,i){"use strict";r=r&&r.hasOwnProperty("default")?r["default"]:r;var s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)};function a(t,e){function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}var u=function(){return(u=Object.assign||function(t){for(var e,r=1,o=arguments.length;r<o;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},c=function R(t){this.sourceId=t},p={FACEBOOK:"facebook",GOOGLE:"google",TWITTER:"twitter",VKONTAKTE:"vkontakte",SKYPE:"skype",GRAVATAR:"gravatar",GITHUB:"github",CUSTOM:"custom",INITIALS:"initials",VALUE:"value"},h=function(){function t(t){this.sourceId=t,this.sourceType=p.FACEBOOK}return t.prototype.getAvatar=function(t){return"https://graph.facebook.com/"+this.sourceId+"/picture?width="+t+"&height="+t},t}(),l=function(){function t(t){this.sourceId=t,this.sourceType=p.TWITTER}return t.prototype.getAvatar=function(t){var e=this.getImageSize(t);return"https://twitter.com/"+this.sourceId+"/profile_image?size="+e},t.prototype.getImageSize=function(t){return t<=24?"mini":t<=48?"normal":t<=73?"bigger":"original"},t}(),f=function(r){function t(t){var e=r.call(this,t)||this;return e.sourceType=p.GOOGLE,e}return a(t,r),t.prototype.getAvatar=function(){return"https://picasaweb.google.com/data/entry/api/user/"+this.sourceId+"?alt=json"},t.prototype.processResponse=function(t,e){var r=t.entry.gphoto$thumbnail.$t;if(r)return r.replace("s64","s"+e)},t}(c),d=function(){function t(t){this.sourceId=t,this.sourceType=p.CUSTOM}return t.prototype.getAvatar=function(){return this.sourceId},t}(),y=function(){function t(t){this.sourceId=t,this.sourceType=p.INITIALS}return t.prototype.getAvatar=function(t){return this.getInitials(this.sourceId,t)},t.prototype.getInitials=function(t,e){if(!(t=t?t.trim():null))return"";var r=t.split(" ");return e&&e<r.length?this.constructInitials(r.slice(0,e)):this.constructInitials(r)},t.prototype.constructInitials=function(t){return t&&t.length?t.filter(function(t){return t&&0<t.length}).map(function(t){return t[0].toUpperCase()}).join(""):""},t}(),g=function(){function t(t){this.value=t,this.sourceType=p.GRAVATAR,this.sourceId=t.match("^[a-f0-9]{32}$")?t:e.Md5.hashStr(t).toString()}return t.prototype.getAvatar=function(t){var e=r()?2*t:t;return"https://secure.gravatar.com/avatar/"+this.sourceId+"?s="+e+"&d=404"},t}(),v=function(){function t(t){this.sourceId=t,this.sourceType=p.SKYPE}return t.prototype.getAvatar=function(){return"https://api.skype.com/users/"+this.sourceId+"/profile/avatar"},t}(),I=function(){function t(t){this.sourceId=t,this.sourceType=p.VALUE}return t.prototype.getAvatar=function(){return this.sourceId},t}(),A=function(r){function t(t){var e=r.call(this,t)||this;return e.sourceType=p.VKONTAKTE,e}return a(t,r),t.prototype.getAvatar=function(t){var e=this.getImageSize(t);return"https://api.vk.com/method/users.get?user_id="+this.sourceId+"&v=5.8&fields="+e},t.prototype.processResponse=function(t){var e=Object.keys(t.response[0]).pop();return t.response[0][e]},t.prototype.getImageSize=function(t){return t<=50?"photo_50":t<=100?"photo_100":t<=200?"photo_200":"photo_max"},t}(c),S=function(r){function t(t){var e=r.call(this,t)||this;return e.sourceType=p.GITHUB,e}return a(t,r),t.prototype.getAvatar=function(){return"https://api.github.com/users/"+this.sourceId},t.prototype.processResponse=function(t,e){return e?t.avatar_url+"&s="+e:t.avatar_url},t}(c),m=function(){function t(){this.sources={},this.sources[p.FACEBOOK]=h,this.sources[p.TWITTER]=l,this.sources[p.GOOGLE]=f,this.sources[p.SKYPE]=v,this.sources[p.GRAVATAR]=g,this.sources[p.CUSTOM]=d,this.sources[p.INITIALS]=y,this.sources[p.VALUE]=I,this.sources[p.VKONTAKTE]=A,this.sources[p.GITHUB]=S}return t.prototype.newInstance=function(t,e){return new this.sources[t](e)},t.decorators=[{type:o.Injectable}],t.ctorParameters=function(){return[]},t}(),T=new o.InjectionToken("avatar.config"),C=[p.FACEBOOK,p.GOOGLE,p.TWITTER,p.VKONTAKTE,p.SKYPE,p.GRAVATAR,p.GITHUB,p.CUSTOM,p.INITIALS,p.VALUE],_=["#1abc9c","#3498db","#f1c40f","#8e44ad","#e74c3c","#d35400","#2c3e50","#7f8c8d"],O=function(){function t(t,e){this.avatarConfig=t,this.http=e,this.avatarSources=C,this.avatarColors=_,this.avatarConfig&&(this.overrideAvatarSources(),this.overrideAvatarColors())}return t.prototype.fetchAvatar=function(t){return this.http.get(t)},t.prototype.getRandomColor=function(t){if(!t)return"transparent";var e=this.calculateAsciiCode(t);return this.avatarColors[e%this.avatarColors.length]},t.prototype.copmareSources=function(t,e){return this.getSourcePriority(t)-this.getSourcePriority(e)},t.prototype.isSource=function(t){return this.avatarSources.includes(t)},t.prototype.isTextAvatar=function(t){return[p.INITIALS,p.VALUE].includes(t)},t.prototype.overrideAvatarSources=function(){},t.prototype.overrideAvatarColors=function(){this.avatarConfig.colors&&0<this.avatarConfig.colors.length&&(this.avatarColors=this.avatarConfig.colors)},t.prototype.calculateAsciiCode=function(t){return t.split("").map(function(t){return t.charCodeAt(0)}).reduce(function(t,e){return t+e})},t.prototype.getSourcePriority=function(t){return this.avatarSources.indexOf(t)},t.decorators=[{type:o.Injectable}],t.ctorParameters=function(){return[{type:undefined,decorators:[{type:o.Optional},{type:o.Inject,args:[T]}]},{type:n.HttpClient}]},t}(),b=function(){function t(t,e,r){this.elementRef=t,this.sourceFactory=e,this.avatarService=r,this.round=!0,this.size=50,this.textSizeRatio=3,this.fgColor="#FFF",this.style={},this.cornerRadius=0,this.clickOnAvatar=new o.EventEmitter,this.avatarStyle={},this.hostStyle={},this._currentSource=0,this._sources=Array()}return t.prototype.handleClickEvent=function(t){t&&this.clickOnAvatar.emit(this._sources[this._currentSource-1])},t.prototype.ngOnChanges=function(t){for(var e in t)if(this.avatarService.isSource(e)){var r=t[e].currentValue;this._addSource(p[e.toUpperCase()],r)}this._initializeAvatar()},t.prototype._initializeAvatar=function(){var r=this;(this._currentSource=0)<this._sources.length&&this._sources[this._currentSource]&&(this._sources.sort(function(t,e){return r.avatarService.copmareSources(t.sourceType,e.sourceType)}),this.hostStyle={width:this.size+"px",height:this.size+"px"},this.fetch())},t.prototype.fetch=function(t){var e=this._sources[this._currentSource];if(!e)return!1;this.avatarService.isTextAvatar(e.sourceType)?(this.data=e.getAvatar(this.initialsSize),this.src=undefined,this.avatarStyle=this._initialsStyle(e.sourceId)):(this.avatarStyle=this._imageStyle(),e instanceof c?this._fetchAsyncAvatar(e):this.src=e.getAvatar(this.size)),this._currentSource++},t.prototype._initialsStyle=function(t){return u({textAlign:"center",borderRadius:this.round?"100%":this.cornerRadius+"px",border:this.borderColor?"1px solid "+this.borderColor:"",textTransform:"uppercase",color:this.fgColor,backgroundColor:this.bgColor?this.bgColor:this.avatarService.getRandomColor(t),font:Math.floor(this.size/this.textSizeRatio)+"px Helvetica, Arial, sans-serif",lineHeight:this.size+"px"},this.style)},t.prototype._imageStyle=function(){return u({maxWidth:"100%",borderRadius:this.round?"50%":this.cornerRadius+"px",border:this.borderColor?"1px solid "+this.borderColor:"",width:this.size,height:this.size},this.style)},t.prototype._fetchAsyncAvatar=function(e){var r=this;this.avatarService.fetchAvatar(e.getAvatar()).subscribe(function(t){r.src=e.processResponse(t,r.size)},function(t){console.error("ngx-avatar: error while fetching "+e.sourceType+" avatar ")})},t.prototype._addSource=function(t,e){e&&(this._updateExistingSource(t,e)||this._sources.push(this.sourceFactory.newInstance(t,e)))},t.prototype._updateExistingSource=function(e,t){var r=this._sources.findIndex(function(t){return t.sourceType===e.toUpperCase()});return-1<r&&(this._sources[r].sourceId=t,!0)},t.decorators=[{type:o.Component,args:[{selector:"ngx-avatar",template:'\n    <div (click)="handleClickEvent($event)" class="avatar-container" [ngStyle]="hostStyle">\n    <img *ngIf="src"\n      [src]="src"\n      [width]="size"\n      [height]="size"\n      [ngStyle]="avatarStyle"\n      (error)="fetch($event)"\n      class="avatar-content"\n     />\n\n   <div *ngIf="data && !src"\n     [ngStyle]="avatarStyle"\n     class="avatar-content">{{data}}</div>\n   </div>',styles:['\n      :host {\n        border-radius: "50%";\n      }\n    ']}]}],t.ctorParameters=function(){return[{type:o.ElementRef},{type:m},{type:O}]},t.propDecorators={round:[{type:o.Input}],size:[{type:o.Input}],textSizeRatio:[{type:o.Input}],bgColor:[{type:o.Input}],fgColor:[{type:o.Input}],borderColor:[{type:o.Input}],style:[{type:o.Input}],cornerRadius:[{type:o.Input}],facebook:[{type:o.Input,args:["facebookId"]}],twitter:[{type:o.Input,args:["twitterId"]}],google:[{type:o.Input,args:["googleId"]}],vkontakte:[{type:o.Input,args:["vkontakteId"]}],skype:[{type:o.Input,args:["skypeId"]}],gravatar:[{type:o.Input,args:["gravatarId"]}],github:[{type:o.Input,args:["githubId"]}],custom:[{type:o.Input,args:["src"]}],initials:[{type:o.Input,args:["name"]}],value:[{type:o.Input,args:["value"]}],placeholder:[{type:o.Input,args:["placeholder"]}],initialsSize:[{type:o.Input,args:["initialsSize"]}],clickOnAvatar:[{type:o.Output}]},t}(),E=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[{provide:T,useValue:t||{}}]}},e.decorators=[{type:o.NgModule,args:[{imports:[i.CommonModule,n.HttpClientModule],declarations:[b],providers:[m,O],exports:[b]}]}],e}();t.AvatarModule=E,t.ɵd=T,t.ɵa=b,t.ɵc=O,t.ɵb=m,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-avatar.umd.min.js.map